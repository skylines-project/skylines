{% from "flights/overview-table.jinja" import render_overview_table with context %}
{% from "macros/links.jinja" import user_link, club_link %}


{% extends "base-page.jinja" %}
{% set active_page = "flights" %}


{% set active_header_tab = 'overview' %}
{% if tab == 'date' -%}
{% set header_tabs = [
    (url_for('.date_overview', date=date), 'overview', _('Overview')),
    (url_for('.date', date=date), 'list', _('List')),
] %}
{%- elif tab == 'latest' %}
{% set header_tabs = [
    (url_for('.latest_overview'), 'overview', _('Overview')),
    (url_for('.latest'), 'list', _('List')),
] %}
{%- elif tab == 'pilot' %}
{% set header_tabs = [
    (url_for('.pilot_overview', id=pilot.id), 'overview', _('Overview')),
    (url_for('.pilot', id=pilot.id), 'list', _('List')),
] %}
{%- elif tab == 'airport' %}
{% set header_tabs = [
    (url_for('.airport_overview', id=airport.id), 'overview', _('Overview')),
    (url_for('.airport', id=airport.id), 'list', _('List')),
] %}
{%- elif tab == 'club' %}
{% set header_tabs = [
    (url_for('.club_overview', id=club.id), 'overview', _('Overview')),
    (url_for('.club', id=club.id), 'list', _('List')),
] %}
{%- elif tab == 'pinned' %}
{% set header_tabs = [
    (url_for('.pinned_overview'), 'overview', _('Overview')),
    (url_for('.pinned'), 'list', _('List')),
] %}
{%- elif tab == 'all' %}
{% set header_tabs = [
    (url_for('.all_overview'), 'overview', _('Overview')),
    (url_for('.all'), 'list', _('List')),
] %}
{%- endif %}


{% block title -%}
{% if date -%}
  {% trans date=h.format_date(date) -%}
    Overview <small>on {{ date }}</small>
  {%- endtrans %}
{%- else %}
  {% trans %}Overview{% endtrans -%}
{%- endif %}
{%- endblock %}



{% block styles -%}
{{ super() }}
{%- endblock %}



{% block scripts -%}
{{ super() }}
<script type="text/javascript" charset="utf-8">
/* <![CDATA[ */
  $(document).ready(function() {
    showPinnedFlightsLink();

    $('#datepicker').datepicker({
      weekStart: 1
    })
    .on('changeDate', function(e) {
      var url = "/flights/date/" + e.date.getFullYear() + "-" +
        pad(e.date.getMonth()+1, 2) + "-" + pad(e.date.getDate(), 2) +
        "/overview";
      window.location.href = url;
    });
  });
/* ]]> */
</script>
{%- endblock %}


{% block content -%}
{% set overview = True %}
{% include "flights/nav.jinja" with context %}

{% if flights -%}
{{ render_overview_table(flights) }}
{%- else %}
No flights today...
{%- endif %}
{%- endblock %}

{% block title_right -%}
<!--
<a href="{{ url_for('upload.index') }}" class="btn btn-success">
  <i class="icon-upload-alt"></i> {{ _('Upload flight') }}
</a>
-->
{%- endblock %}
